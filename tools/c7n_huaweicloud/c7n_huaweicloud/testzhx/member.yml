policies:
  - name: HW-CTS-01-filter-resources-member
    resource: huaweicloud.cts-tracker

    filters:
      # 筛选名称为"system"的追踪器
      - type: value
        key: tracker_name
        value: "system"
      # 筛选非组织追踪器
      - type: value
        key: is_organization_tracker
        value: false
      - or:
        - type: value
          key: "obs_info.bucket_name"
          op: eq
          value: ""
        - type: value
          key: "obs_info.bucket_name"
          value_type: swap
          op: eq
          value: null
        - type: value
          key: "is_support_validate"
          op: eq
          value: false
        - type: value
          key: "kms_id"
          value_type: swap
          op: eq
          value: null

    actions:
      - type: set-trace-file-validation-with-lts-preservation
        tracker_name: "system"
        tracker_type: "system"
        agency_name: "cts_admin_trust"
        status: "enabled"
        is_organization_tracker: false

        is_support_validate: true
        kms_id: "7d11203a-c426-49a3-a8c8-25e4e6f1fba1"
        is_support_trace_files_encryption: true
        obs_info:
          bucket_name: "bj4-guazhou1"
          file_prefix_name: ""
          is_obs_created: false
          compress_type: "gzip"
          is_sort_by_service: true